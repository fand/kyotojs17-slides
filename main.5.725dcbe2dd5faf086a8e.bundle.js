(window.webpackJsonp=window.webpackJsonp||[]).push([[5],[,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(43);t.VFXProvider=a.VFXProvider;var i=n(55);t.VFXImg=i.VFXImg;var o=n(56);t.VFXVideo=o.VFXVideo;var l=r(n(57));t.VFXSpan=l.default("span"),t.VFXDiv=l.default("div"),t.VFXP=l.default("p")},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.VFXContext=r.createContext(null)},function(e,t,n){e.exports=n.p+"7ef5ad39f64276ea868280e35d9520d4.webp"},,function(e,t,n){"use strict";var r=n(2),a=n.n(r),i=n(10),o=n.n(i),l=(n(34),n(35),n(36),n(37),n(38),n(39),n(40),n(23)),c=n.n(l);n(42);var u=n(3);n.d(t,"a",function(){return s});var s=Object(r.memo)(function(e){var t=e.slides,n=e.onChangeSlideIndex;e.hash;function i(){window.slide||(window.slide=function(e){var t=e.showIndex,n=void 0!==t&&t;return new window.WebSlides({loop:!0,showIndex:n,navigateOnScroll:!1})}({}),window.slide.el.addEventListener("ws:slide-change",function(e){n&&n(e.detail.currentSlide0)}))}return e.isJumpPage?setTimeout(function(){i(),o.a.highlightAll()},0):(i(),o.a.highlightAll()),Object(r.useEffect)(function(){i()},[]),a.a.createElement(u.VFXProvider,{pixelRatio:1.5},a.a.createElement("article",{className:void 0,id:"webslides"},t.map(function(e,t){var n=e.slide,r=e.fusumaProps;return a.a.createElement("section",{key:t,className:c()("aligncenter",r.classes,r.sectionTitle?"section-title":void 0)},a.a.createElement(n,null))})))},function(e,t){return e.hash===t.hash})},,function(e,t,n){e.exports=n.p+"slides/vj.mp4"},,,,function(e,t,n){e.exports=n.p+"7f98c4fab93b97f2f08f5caa3ed2edf3.webp"},function(e,t,n){e.exports=n.p+"31b29d0a08f132fd968925bbe7ec508e.webp"},function(e,t,n){e.exports=n.p+"819899fef43514cb514eab83a6df0f76.webp"},function(e,t,n){e.exports=n.p+"e027e0f7b3f8a1ab7b21630916f5e6fc.webp"},function(e,t,n){e.exports=n.p+"f55a8c18a711d6d1c5fb171fd38ceb08.webp"},function(e,t,n){e.exports=n.p+"4765115dd56af458f412e6b90436e010.webp"},function(e,t,n){e.exports=n.p+"eff25521ca651168825b9cf1d5f9f7dc.webp"},function(e,t,n){e.exports=n.p+"8ba42b9c4ce1d4f1d6fd15ebc68d9f65.webp"},,,,function(e,t,n){n(27),n(73),n(69),e.exports=n(70)},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(2)),l=n(2),c=n(6),u=i(n(44)),s={position:"fixed",top:0,left:0,width:"100vw",height:"100vh","z-index":9999,"pointer-events":"none"};t.VFXProvider=function(e){var t=r(l.useState(null),2),n=t[0],a=t[1];return console.log("?????????? log"),l.useEffect(function(){for(var t=document.createElement("canvas"),n=0,i=Object.entries(s);n<i.length;n++){var o=r(i[n],2),l=o[0],c=o[1];t.style.setProperty(l,c.toString())}document.body.appendChild(t);var f=new u.default(t,e.pixelRatio);return a(f),f.play(),function(){f.stop(),f.destroy(),t.remove()}},[e.pixelRatio]),o.createElement(o.Fragment,null,o.createElement(c.VFXContext.Provider,{value:n},e.children))}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function l(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,l)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(45)),c=o(n(46)),u=n(47),s=o(n(48)),f=new Map,p=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.isPlaying=!1,this.pixelRatio=2,this.elements=[],this.w=0,this.h=0,this.scrollX=0,this.scrollY=0,this.mouseX=0,this.mouseY=0,this.resize=function(){return a(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,a,i,o,l,c,u,s,f,p,m,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof window){e.next=63;break}t=!0,n=!1,r=void 0,e.prev=4,a=this.elements[Symbol.iterator]();case 6:if(t=(i=a.next()).done){e.next=18;break}if("text"!==(o=i.value).type||!o.isInViewport){e.next=15;break}if((l=o.element.getBoundingClientRect()).width===o.width&&l.height===o.height){e.next=15;break}return e.next=13,this.rerender(o);case 13:o.width=l.width,o.height=l.height;case 15:t=!0,e.next=6;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(4),n=!0,r=e.t0;case 24:e.prev=24,e.prev=25,t||null==a.return||a.return();case 27:if(e.prev=27,!n){e.next=30;break}throw r;case 30:return e.finish(27);case 31:return e.finish(24);case 32:c=!0,u=!1,s=void 0,e.prev=35,f=this.elements[Symbol.iterator]();case 37:if(c=(p=f.next()).done){e.next=49;break}if("text"!==(m=p.value).type||m.isInViewport){e.next=46;break}if((d=m.element.getBoundingClientRect()).width===m.width&&d.height===m.height){e.next=46;break}return e.next=44,this.rerender(m);case 44:m.width=d.width,m.height=d.height;case 46:c=!0,e.next=37;break;case 49:e.next=55;break;case 51:e.prev=51,e.t1=e.catch(35),u=!0,s=e.t1;case 55:e.prev=55,e.prev=56,c||null==f.return||f.return();case 58:if(e.prev=58,!u){e.next=61;break}throw s;case 61:return e.finish(58);case 62:return e.finish(55);case 63:case"end":return e.stop()}},e,this,[[4,20,24,32],[25,,27,31],[35,51,55,63],[56,,58,62]])}))},this.scroll=function(){"undefined"!=typeof window&&(r.scrollX=window.scrollX,r.scrollY=window.scrollY)},this.mousemove=function(e){"undefined"!=typeof window&&(r.mouseX=e.clientX,r.mouseY=window.innerHeight-e.clientY)},this.playLoop=function(){var e=Date.now()/1e3;r.renderer.clear(),r.updateCanvasSize(),r.elements.forEach(function(t){var n=t.element.getBoundingClientRect(),a=r.isRectInViewport(n);if(a&&!t.isInViewport&&(t.enterTime=e),t.isInViewport=a,t.isInViewport){t.uniforms.time.value=e-t.startTime,t.uniforms.enterTime.value=-1===t.enterTime?0:e-t.enterTime,t.uniforms.resolution.value.x=n.width*r.pixelRatio,t.uniforms.resolution.value.y=n.height*r.pixelRatio,t.uniforms.offset.value.x=n.left*r.pixelRatio,t.uniforms.offset.value.y=(window.innerHeight-n.top-n.height)*r.pixelRatio,t.uniforms.mouse.value.x=r.mouseX*r.pixelRatio,t.uniforms.mouse.value.y=r.mouseY*r.pixelRatio;var i=f.get(t.element);void 0!==i&&i.update(),("video"===t.type||t.isGif)&&(t.uniforms.src.value.needsUpdate=!0),r.camera.lookAt(t.scene.position),r.renderer.setViewport(n.left,window.innerHeight-(n.top+n.height),n.width,n.height);try{r.renderer.render(t.scene,r.camera)}catch(t){console.error(t)}}}),r.isPlaying&&requestAnimationFrame(r.playLoop)},this.renderer=new l.WebGLRenderer({canvas:t,alpha:!0}),this.renderer.autoClear=!1,"undefined"!=typeof window&&(this.pixelRatio=n||window.devicePixelRatio,window.addEventListener("resize",this.resize),window.addEventListener("scroll",this.scroll,{passive:!0}),window.addEventListener("mousemove",this.mousemove)),this.resize(),this.scroll(),this.camera=new l.OrthographicCamera(-1,1,1,-1,.1,10),this.camera.position.set(0,0,1)}var t,n,i;return t=e,(n=[{key:"destroy",value:function(){"undefined"!=typeof window&&(window.removeEventListener("resize",this.resize),window.removeEventListener("scroll",this.scroll),window.removeEventListener("mousemove",this.mousemove))}},{key:"updateCanvasSize",value:function(){if("undefined"!=typeof window){var e=window.innerWidth,t=window.innerHeight;this.canvas.width=e,this.canvas.height=t,this.renderer.setSize(e,t),this.renderer.setPixelRatio(this.pixelRatio),this.w=e,this.h=t}}},{key:"rerender",value:function(e){return a(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.uniforms.src,t.prev=1,e.element.style.setProperty("opacity","1"),t.next=5,c.default(e.element);case 5:if(0!==(r=t.sent).width&&0!==r.width){t.next=8;break}throw"omg";case 8:e.element.style.setProperty("opacity","0"),(a=new l.Texture(r)).needsUpdate=!0,n.value=a,t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),console.error(t.t0);case 17:case"end":return t.stop()}},t,null,[[1,14]])}))}},{key:"addElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,a,i,o,p,m,d,b,v,h,g,O,j,y,x;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.shader||"uvGradient",a=u.shaders[r]||r,i=e.getBoundingClientRect(),o=this.isRectInViewport(i),d=!1,!(e instanceof HTMLImageElement)){n.next=19;break}if(m="img",!(d=!!e.src.match(/\.gif/i))){n.next=16;break}return n.next=11,s.default.create(e.src,this.pixelRatio);case 11:b=n.sent,f.set(e,b),p=new l.Texture(b.getCanvas()),n.next=17;break;case 16:p=new l.Texture(e);case 17:n.next=29;break;case 19:if(!(e instanceof HTMLVideoElement)){n.next=24;break}p=new l.VideoTexture(e),m="video",n.next=29;break;case 24:return n.next=26,c.default(e);case 26:v=n.sent,p=new l.Texture(v),m="text";case 29:p.minFilter=l.LinearFilter,p.magFilter=l.LinearFilter,p.format=l.RGBAFormat,p.needsUpdate=!0,e.style.setProperty("opacity","0"),h={src:{type:"t",value:p},resolution:{type:"v2",value:new l.Vector2},offset:{type:"v2",value:new l.Vector2},time:{type:"f",value:0},enterTime:{type:"f",value:-1},mouse:{type:"v2",value:new l.Vector2}},g=new l.Scene,O=new l.PlaneGeometry(2,2),(j=new l.ShaderMaterial({vertexShader:u.DEFAULT_VERTEX_SHADER,fragmentShader:a,transparent:!0,uniforms:h})).extensions={derivatives:!0,drawBuffers:!0,fragDepth:!0,shaderTextureLOD:!0},g.add(new l.Mesh(O,j)),y=Date.now()/1e3,x={type:m,element:e,isInViewport:o,width:i.width,height:i.height,scene:g,uniforms:h,startTime:y,enterTime:o?y:-1,isGif:d},this.elements.push(x);case 43:case"end":return n.stop()}},n,this)}))}},{key:"removeElement",value:function(e){var t=this.elements.findIndex(function(t){return t.element===e});-1!==t&&this.elements.splice(t,1)}},{key:"updateElement",value:function(e){var t=this.elements.findIndex(function(t){return t.element===e});return-1!==t?this.rerender(this.elements[t]):Promise.reject()}},{key:"play",value:function(){this.isPlaying=!0,this.playLoop()}},{key:"stop",value:function(){this.isPlaying=!1}},{key:"isRectInViewport",value:function(e){return e.left<=this.w&&e.right>=0&&e.top<=this.h&&e.bottom>=0}}])&&r(t.prototype,n),i&&r(t,i),e}();t.default=p},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=document.implementation.createHTMLDocument("test"),n=t.createRange();n.selectNodeContents(t.documentElement),n.deleteContents();var r=document.createElement("head");return t.documentElement.appendChild(r),t.documentElement.appendChild(n.createContextualFragment(e)),t.documentElement.setAttribute("xmlns",t.documentElement.namespaceURI),(new XMLSerializer).serializeToString(t).replace(/<!DOCTYPE html>/,"")};t.default=function(e){var t=e.getBoundingClientRect(),n=document.createElement("canvas");n.width=Math.max(1.01*t.width,t.width+1),n.height=Math.max(1.01*t.height,t.height+1);var a=e.cloneNode(),i=window.getComputedStyle(e,""),o=i.cssText;a.setAttribute("style",o),a.style.setProperty("margin","0"),a.innerHTML=e.innerHTML;var l=document.createElement("div");l.style.setProperty("text-align",i.textAlign),l.style.setProperty("vertical-align",i.verticalAlign),l.appendChild(a);var c=l.outerHTML,u=r(c),s='<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(n.width,'" height="').concat(n.height,'">')+'<foreignObject width="100%" height="100%">'.concat(u,"</foreignObject></svg>");return new Promise(function(e,t){var r=new Image;r.onload=function(){var a=n.getContext("2d");if(null===a)return t();a.drawImage(r,0,0),e(n)},r.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(s))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_VERTEX_SHADER="\nprecision mediump float;\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",t.shaders={uvGradient:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n    void main() {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n\n        gl_FragColor = vec4(uv, sin(time) * .5 + .5, 1);\n\n        vec4 img = texture2D(src, uv);\n        gl_FragColor *= smoothstep(0., 1., img.a);\n    }\n    ",rainbow:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    vec3 hsv2rgb(vec3 c) {\n        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }\n\n    vec3 rgb2hsv(vec3 c) {\n        vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n        vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n        float d = q.x - min(q.w, q.y);\n        float e = 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n    }\n\n    vec3 hueShift(vec3 rgb, float t) {\n        vec3 hsv = rgb2hsv(rgb);\n        hsv.x = fract(hsv.x + t);\n        return hsv2rgb(hsv);\n    }\n\n    void main() {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n\n        vec2 uv2 = uv;\n        uv2.x *= resolution.x / resolution.y;\n\n        float x = (uv2.x - uv2.y) - fract(time);\n\n        vec4 img = texture2D(src, uv);\n        float gray = length(img.rgb);\n\n        img.rgb = vec3(hueShift(vec3(1,0,0), x) * gray);\n\n        gl_FragColor = img;\n    }\n    ",glitch:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    float nn(float y, float t) {\n        float n = (\n            sin(y * .07 + t * 8. + sin(y * .5 + t * 10.)) +\n            sin(y * .7 + t * 2. + sin(y * .3 + t * 8.)) * .7 +\n            sin(y * 1.1 + t * 2.8) * .4\n        );\n\n        n += sin(y * 124. + t * 100.7) * sin(y * 877. - t * 38.8) * .3;\n\n        return n;\n    }\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n        vec4 color = texture2D(src, uv);\n\n        float t = mod(time, 3.14 * 10.);\n\n        // Seed value\n        float v = fract(sin(t * 2.) * 700.);\n\n        if (abs(nn(uv.y, t)) < 1.2) {\n            v *= 0.01;\n        }\n\n        // Prepare for chromatic Abbreveation\n        vec2 focus = vec2(0.5);\n        float d = v * 0.6;\n        vec2 ruv = fract(focus + (uv - focus) * (1. - d));\n        vec2 guv = fract(focus + (uv - focus) * (1. - 2. * d));\n        vec2 buv = fract(focus + (uv - focus) * (1. - 3. * d));\n\n        // Random Glitch\n        if (v > 0.1) {\n            // Randomize y\n            float y = floor(uv.y * 13. * sin(35. * t)) + 1.;\n            if (sin(36. * y * v) > 0.9) {\n                ruv.x = fract(uv.x + sin(76. * y) * 0.1);\n                guv.x = fract(uv.x + sin(34. * y) * 0.1);\n                buv.x = fract(uv.x + sin(59. * y) * 0.1);\n            }\n\n            // RGB Shift\n            v = pow(v * 1.5, 2.) * 0.15;\n            color.rgb *= 0.3;\n            color.r += texture2D(src, vec2(uv.x + sin(t * 123.45) * v, uv.y)).r;\n            color.g += texture2D(src, vec2(uv.x + sin(t * 157.67) * v, uv.y)).g;\n            color.b += texture2D(src, vec2(uv.x + sin(t * 143.67) * v, uv.y)).b;\n        }\n\n        // Compose Chromatic Abbreveation\n        if (abs(nn(uv.y, t)) > 1.1) {\n            color.r = color.r * 0.5 + color.r * texture2D(src, ruv).r;\n            color.g = color.g * 0.5 + color.g * texture2D(src, guv).g;\n            color.b = color.b * 0.5 + color.b * texture2D(src, buv).b;\n            color *= 2.;\n        }\n\n        gl_FragColor = color;\n        gl_FragColor.a = step(.1, length(color.rgb));\n    }\n    ",pixelate:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n\n        float b = sin(time * 2.) * 32. + 48.;\n        uv = floor(uv * b) / b;\n        gl_FragColor = texture2D(src, uv);\n    }\n    ",rgbGlitch:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    float random(vec2 st) {\n        return fract(sin(dot(st, vec2(948.,824.))) * 30284.);\n    }\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n        vec2 uvr = uv, uvg = uv, uvb = uv;\n\n        float tt = mod(time, 17.);\n\n        if (fract(tt * 0.3) > .9 || fract(tt * 0.71) > .9) {\n            float t = floor(tt * 13.);\n\n            float n = random(vec2(t, floor(uv.y * 3.7)));\n            if (n > .7) {\n                uvr.x = fract(uvr.x + random(vec2(t, 1.)) * .03);\n                uvg.x = fract(uvr.x + random(vec2(t, 2.)) * .03);\n                uvb.x = fract(uvr.x + random(vec2(t, 3.)) * .03);\n            }\n\n            float ny = random(vec2(t * 17. + floor(uv * 13.7)));\n            if (ny > .7) {\n                uvr.x = fract(uvr.x + random(vec2(t, 1.)) * .1);\n                uvg.x = fract(uvr.x + random(vec2(t, 2.)) * .1);\n                uvb.x = fract(uvr.x + random(vec2(t, 3.)) * .1);\n            }\n        }\n\n        vec4 cr = texture2D(src, uvr);\n        vec4 cg = texture2D(src, uvg);\n        vec4 cb = texture2D(src, uvb);\n\n        gl_FragColor = vec4(\n            cr.r,\n            cg.g,\n            cb.b,\n            step(.1, cr.a + cg.a + cb.a)\n        );\n    }\n    ",rgbShift:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    float nn(float y, float t) {\n        float n = (\n            sin(y * .07 + t * 8. + sin(y * .5 + t * 10.)) +\n            sin(y * .7 + t * 2. + sin(y * .3 + t * 8.)) * .7 +\n            sin(y * 1.1 + t * 2.8) * .4\n        );\n\n        n += sin(y * 124. + t * 100.7) * sin(y * 877. - t * 38.8) * .3;\n\n        return n;\n    }\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n        vec2 uvr = uv, uvg = uv, uvb = uv;\n\n        float t = mod(time, 30.);\n\n        float amp = 10. / resolution.x;\n\n        if (abs(nn(uv.y, t)) > 1.) {\n            uvr.x += nn(uv.y, t) * amp;\n            uvg.x += nn(uv.y, t + 10.) * amp;\n            uvb.x += nn(uv.y, t + 20.) * amp;\n        }\n\n        vec4 cr = texture2D(src, fract(uvr));\n        vec4 cg = texture2D(src, fract(uvg));\n        vec4 cb = texture2D(src, fract(uvb));\n\n        gl_FragColor = vec4(\n            cr.r,\n            cg.g,\n            cb.b,\n            step(.1, cr.a + cg.a + cb.a)\n        );\n    }\n    ",halftone:'\n    // Halftone Effect by zoidberg\n    // https://www.interactiveshaderformat.com/sketches/234\n\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    // TODO: uniform\n    #define gridSize 10.0\n    #define dotSize 0.7\n    #define smoothing 0.15\n    #define speed 1.0\n\n    #define IMG_PIXEL(x, y) texture2D(x, (y - offset) / resolution);\n\n    vec4 gridRot = vec4(15.0, 45.0, 75.0, 0.0);\n\n    // during calculation we find the closest dot to a frag, determine its size, and then determine the size of the four dots above/below/right/left of it. this array of offsets move "one left", "one up", "one right", and "one down"...\n    vec2 originOffsets[4];\n\n    void main() {\n        vec2 fragCoord = gl_FragCoord.xy - offset;\n\n        // a halftone is an overlapping series of grids of dots\n        // each grid of dots is rotated by a different amount\n        // the size of the dots determines the colors. the shape of the dot should never change (always be a dot with regular edges)\n        originOffsets[0] = vec2(-1.0, 0.0);\n        originOffsets[1] = vec2(0.0, 1.0);\n        originOffsets[2] = vec2(1.0, 0.0);\n        originOffsets[3] = vec2(0.0, -1.0);\n\n        vec3 rgbAmounts = vec3(0.0);\n\n        // for each of the channels (i) of RGB...\n        for (float i=0.0; i<3.0; ++i) {\n            // figure out the rotation of the grid in radians\n            float rotRad = radians(gridRot[int(i)]);\n\n            // the grids are rotated counter-clockwise- to find the nearest dot, take the fragment pixel loc,\n            // rotate it clockwise, and split by the grid to find the center of the dot. then rotate this\n            // coord counter-clockwise to yield the location of the center of the dot in pixel coords local to the render space\n            mat2 ccTrans = mat2(vec2(cos(rotRad), sin(rotRad)), vec2(-1.0*sin(rotRad), cos(rotRad)));\n            mat2 cTrans = mat2(vec2(cos(rotRad), -1.0*sin(rotRad)), vec2(sin(rotRad), cos(rotRad)));\n\n            // find the location of the frag in the grid (prior to rotating it)\n            vec2 gridFragLoc = cTrans * fragCoord.xy;\n\n            // find the center of the dot closest to the frag- there\'s no "round" in GLSL 1.2, so do a "floor" to find the dot to the bottom-left of the frag, then figure out if the frag would be in the top and right halves of that square to find the closest dot to the frag\n            vec2 gridOriginLoc = vec2(floor(gridFragLoc.x/gridSize), floor(gridFragLoc.y/gridSize));\n\n            vec2 tmpGridCoords = gridFragLoc/vec2(gridSize);\n            bool fragAtTopOfGrid = ((tmpGridCoords.y-floor(tmpGridCoords.y)) > (gridSize/2.0)) ? true : false;\n            bool fragAtRightOfGrid = ((tmpGridCoords.x-floor(tmpGridCoords.x)) > (gridSize/2.0)) ? true : false;\n            if (fragAtTopOfGrid)\n                gridOriginLoc.y = gridOriginLoc.y + 1.0;\n            if (fragAtRightOfGrid)\n                gridOriginLoc.x = gridOriginLoc.x + 1.0;\n\n            // ...at this point, "gridOriginLoc" contains the grid coords of the nearest dot to the fragment being rendered\n            // convert the location of the center of the dot from grid coords to pixel coords\n            vec2 gridDotLoc = vec2(gridOriginLoc.x*gridSize, gridOriginLoc.y*gridSize) + vec2(gridSize/2.0);\n\n            // rotate the pixel coords of the center of the dot so they become relative to the rendering space\n            vec2 renderDotLoc = ccTrans * gridDotLoc;\n\n            // get the color of the pixel of the input image under this dot (the color will ultimately determine the size of the dot)\n            vec4 renderDotImageColorRGB = IMG_PIXEL(src, renderDotLoc + offset);\n\n            // the amount of this channel is taken from the same channel of the color of the pixel of the input image under this halftone dot\n            float imageChannelAmount = renderDotImageColorRGB[int(i)];\n\n            // the size of the dot is determined by the value of the channel\n            float dotRadius = imageChannelAmount * (gridSize * dotSize);\n            float fragDistanceToDotCenter = distance(fragCoord.xy, renderDotLoc);\n            if (fragDistanceToDotCenter < dotRadius) {\n                rgbAmounts[int(i)] += smoothstep(dotRadius, dotRadius-(dotRadius*smoothing), fragDistanceToDotCenter);\n            }\n\n            // calcluate the size of the dots abov/below/to the left/right to see if they\'re overlapping\n            for (float j=0.0; j<4.0; ++j) {\n                gridDotLoc = vec2((gridOriginLoc.x+originOffsets[int(j)].x)*gridSize, (gridOriginLoc.y+originOffsets[int(j)].y)*gridSize) + vec2(gridSize/2.0);\n\n                renderDotLoc = ccTrans * gridDotLoc;\n                renderDotImageColorRGB = IMG_PIXEL(src, renderDotLoc + offset);\n\n                imageChannelAmount = renderDotImageColorRGB[int(i)];\n                dotRadius = imageChannelAmount * (gridSize*1.50/2.0);\n                fragDistanceToDotCenter = distance(fragCoord.xy, renderDotLoc);\n                if (fragDistanceToDotCenter < dotRadius) {\n                    rgbAmounts[int(i)] += smoothstep(dotRadius, dotRadius-(dotRadius*smoothing), fragDistanceToDotCenter);\n                }\n            }\n        }\n\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n        vec4 original = texture2D(src, uv);\n        float alpha = step(.1, rgbAmounts[0] + rgbAmounts[1] + rgbAmounts[2] + original.a);\n\n        gl_FragColor = vec4(rgbAmounts[0], rgbAmounts[1], rgbAmounts[2], alpha);\n    }\n    ',sinewave:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n        vec2 uvr = uv, uvg = uv, uvb = uv;\n\n        float amp = 20. / resolution.x;\n\n        uvr.x += sin(uv.y * 7. + time * 3.) * amp;\n        uvg.x += sin(uv.y * 7. + time * 3. + .4) * amp;\n        uvb.x += sin(uv.y * 7. + time * 3. + .8) * amp;\n\n        vec4 cr = texture2D(src, uvr) * step(0., uvr.x) * step(uvr.x, 1.);\n        vec4 cg = texture2D(src, uvg) * step(0., uvg.x) * step(uvg.x, 1.);\n        vec4 cb = texture2D(src, uvb) * step(0., uvb.x) * step(uvb.x, 1.);\n\n        gl_FragColor = vec4(\n            cr.r,\n            cg.g,\n            cb.b,\n            cr.a + cg.a + cb.a\n        );\n    }\n    ",shine:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n\n        vec2 p = uv * 2. - 1.;\n        float a = atan(p.y, p.x);\n\n        vec4 col = texture2D(src, uv);\n        float gray = length(col.rgb);\n\n        float level = 1. + sin(a * 10. + time * 3.) * 0.2;\n\n        gl_FragColor = vec4(1, 1, .5, col.a) * level;\n    }\n    ",blink:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n\n        gl_FragColor = texture2D(src, uv) * (sin(time * 5.) * 0.2 + 0.8);\n    }\n\n    ",spring:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform sampler2D src;\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n        uv = (uv - .5) * (1.05 + sin(time * 5.) * 0.05) + .5;\n\n        if (uv.x < 0. || uv.x > 1. || uv.y < 0. || uv.y > 1.) { discard; }\n\n        gl_FragColor = texture2D(src, uv);\n    }\n    ",warpTransition:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform float enterTime;\n    uniform sampler2D src;\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n\n        if (enterTime < 1.5) {\n            float t = enterTime / 1.5;\n            uv.x += sin(floor(uv.y * 300.)) * 3. * exp(t * -10.);\n        }\n\n        gl_FragColor = texture2D(src, uv);\n    }\n    ",slitScanTransition:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform float enterTime;\n    uniform sampler2D src;\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n\n        if (enterTime < 1.5) {\n            float t = 1. - enterTime / 1.5;\n            uv.y = uv.y > t ? uv.y : t;\n        }\n\n        gl_FragColor = texture2D(src, uv);\n    }\n    ",pixelateTransition:"\n    precision mediump float;\n    uniform vec2 resolution;\n    uniform vec2 offset;\n    uniform float time;\n    uniform float enterTime;\n    uniform sampler2D src;\n\n    void main (void) {\n        vec2 uv = (gl_FragCoord.xy - offset) / resolution;\n\n        if (enterTime < 1.5) {\n            float t = enterTime / 1.5;\n\n            float b = floor(t * 64.);\n            uv = (floor(uv * b) + .5) / b;\n        }\n\n        gl_FragColor = texture2D(src, uv);\n    }\n    "}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function l(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,l)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(49)),l=function(){function e(t,n,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.frames=[],this.index=0,this.playTime=0,this.frames=t,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.pixelRatio=a,this.canvas.width=n,this.canvas.height=r,this.startTime=Date.now()}var t,n,i;return t=e,i=[{key:"create",value:function(t,n){return a(this,void 0,void 0,regeneratorRuntime.mark(function r(){var a,i,l,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch(t).then(function(e){return e.arrayBuffer()}).then(function(e){return new o.default(e)});case 2:return a=r.sent,i=a.decompressFrames(!0),l=a.raw.lsd.width,c=a.raw.lsd.height,r.abrupt("return",new e(i,l,c,n));case 7:case"end":return r.stop()}},r)}))}}],(n=[{key:"getCanvas",value:function(){return this.canvas}},{key:"update",value:function(){for(var e=Date.now()-this.startTime;this.playTime<e;){var t=this.frames[this.index%this.frames.length];this.playTime+=t.delay,this.index++}var n=this.frames[this.index%this.frames.length],r=new ImageData(n.patch,n.dims.width,n.dims.height);this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.putImageData(r,n.dims.left,n.dims.top)}}])&&r(t.prototype,n),i&&r(t,i),e}();t.default=l},function(e,t,n){"use strict";var r=n(50);e.exports=r},function(e,t,n){"use strict";var r=n(51),a=n(53);function i(e){var t=new Uint8Array(e),n=new r(t);this.raw=n.parse(a),this.raw.hasImages=!1;for(var i=0;i<this.raw.frames.length;i++)if(this.raw.frames[i].image){this.raw.hasImages=!0;break}}i.prototype.decompressFrame=function(e,t){if(e>=this.raw.frames.length)return null;var n=this.raw.frames[e];if(n.image){var r=n.image.descriptor.width*n.image.descriptor.height,a=function(e,t,n){var r,a,i,o,l,c,u,s,f,p,m,d,b,v,h,g,O=n,j=new Array(n),y=new Array(4096),x=new Array(4096),w=new Array(4097);for(l=1+(a=1<<(d=e)),r=a+2,u=-1,i=(1<<(o=d+1))-1,f=0;f<a;f++)y[f]=0,x[f]=f;for(m=s=b=v=g=h=0,p=0;p<O;){if(0===v){if(s<o){m+=t[h]<<s,s+=8,h++;continue}if(f=m&i,m>>=o,s-=o,f>r||f==l)break;if(f==a){i=(1<<(o=d+1))-1,r=a+2,u=-1;continue}if(-1==u){w[v++]=x[f],u=f,b=f;continue}for(c=f,f==r&&(w[v++]=b,f=u);f>a;)w[v++]=x[f],f=y[f];b=255&x[f],w[v++]=b,r<4096&&(y[r]=u,x[r]=b,0==(++r&i)&&r<4096&&(o++,i+=r)),u=c}v--,j[g++]=w[v],p++}for(p=g;p<O;p++)j[p]=0;return j}(n.image.data.minCodeSize,n.image.data.blocks,r);n.image.descriptor.lct.interlaced&&(a=function(e,t){for(var n=new Array(e.length),r=e.length/t,a=function(r,a){var i=e.slice(a*t,(a+1)*t);n.splice.apply(n,[r*t,t].concat(i))},i=[0,4,2,1],o=[8,8,4,2],l=0,c=0;c<4;c++)for(var u=i[c];u<r;u+=o[c])a(u,l),l++;return n}(a,n.image.descriptor.width));var i={pixels:a,dims:{top:n.image.descriptor.top,left:n.image.descriptor.left,width:n.image.descriptor.width,height:n.image.descriptor.height}};return n.image.descriptor.lct&&n.image.descriptor.lct.exists?i.colorTable=n.image.lct:i.colorTable=this.raw.gct,n.gce&&(i.delay=10*(n.gce.delay||10),i.disposalType=n.gce.extras.disposal,n.gce.extras.transparentColorGiven&&(i.transparentIndex=n.gce.transparentColorIndex)),t&&(i.patch=function(e){for(var t=e.pixels.length,n=new Uint8ClampedArray(4*t),r=0;r<t;r++){var a=4*r,i=e.pixels[r],o=e.colorTable[i];n[a]=o[0],n[a+1]=o[1],n[a+2]=o[2],n[a+3]=i!==e.transparentIndex?255:0}return n}(i)),i}return null},i.prototype.decompressFrames=function(e,t,n){void 0===t&&(t=0),n=void 0===n?this.raw.frames.length:Math.min(n,this.raw.frames.length);for(var r=[],a=t;a<n;a++){this.raw.frames[a].image&&r.push(this.decompressFrame(a,e))}return r},e.exports=i},function(e,t,n){"use strict";var r=n(52);function a(e){this.stream=new r(e),this.output={}}a.prototype.parse=function(e){return this.parseParts(this.output,e),this.output},a.prototype.parseParts=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];this.parsePart(e,r)}},a.prototype.parsePart=function(e,t){var n,r=t.label;if(!t.requires||t.requires(this.stream,this.output,e))if(t.loop){for(var a=[];t.loop(this.stream);){var i={};this.parseParts(i,t.parts),a.push(i)}e[r]=a}else t.parts?(n={},this.parseParts(n,t.parts),e[r]=n):t.parser?(n=t.parser(this.stream,this.output,e),t.skip||(e[r]=n)):t.bits&&(e[r]=this.parseBits(t.bits))},a.prototype.parseBits=function(e){var t={},n=this.stream.readBitArray();for(var r in e){var a=e[r];a.length?t[r]=n.slice(a.index,a.index+a.length).reduce(function(e,t){return 2*e+t},0):t[r]=n[a.index]}return t},e.exports=a},function(e,t,n){"use strict";function r(e){this.data=e,this.pos=0}r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.peekByte=function(){return this.data[this.pos]},r.prototype.readBytes=function(e){return this.data.subarray(this.pos,this.pos+=e)},r.prototype.peekBytes=function(e){return this.data.subarray(this.pos,this.pos+e)},r.prototype.readString=function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(this.readByte());return t},r.prototype.readBitArray=function(){for(var e=[],t=this.readByte(),n=7;n>=0;n--)e.push(!!(t&1<<n));return e},r.prototype.readUnsigned=function(e){var t=this.readBytes(2);return e?(t[1]<<8)+t[0]:(t[0]<<8)+t[1]},e.exports=r},function(e,t,n){"use strict";var r=n(54),a={label:"blocks",parser:function(e){for(var t=[],n=0,r=e.readByte();0!==r;r=e.readByte())t.push(e.readBytes(r)),n+=r;var a=new Uint8Array(n);n=0;for(var i=0;i<t.length;i++)a.set(t[i],n),n+=t[i].length;return a}},i={label:"gce",requires:function(e){var t=e.peekBytes(2);return 33===t[0]&&249===t[1]},parts:[{label:"codes",parser:r.readBytes(2),skip:!0},{label:"byteSize",parser:r.readByte()},{label:"extras",bits:{future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}}},{label:"delay",parser:r.readUnsigned(!0)},{label:"transparentColorIndex",parser:r.readByte()},{label:"terminator",parser:r.readByte(),skip:!0}]},o={label:"image",requires:function(e){return 44===e.peekByte()},parts:[{label:"code",parser:r.readByte(),skip:!0},{label:"descriptor",parts:[{label:"left",parser:r.readUnsigned(!0)},{label:"top",parser:r.readUnsigned(!0)},{label:"width",parser:r.readUnsigned(!0)},{label:"height",parser:r.readUnsigned(!0)},{label:"lct",bits:{exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}}}]},{label:"lct",requires:function(e,t,n){return n.descriptor.lct.exists},parser:r.readArray(3,function(e,t,n){return Math.pow(2,n.descriptor.lct.size+1)})},{label:"data",parts:[{label:"minCodeSize",parser:r.readByte()},a]}]},l={label:"text",requires:function(e){var t=e.peekBytes(2);return 33===t[0]&&1===t[1]},parts:[{label:"codes",parser:r.readBytes(2),skip:!0},{label:"blockSize",parser:r.readByte()},{label:"preData",parser:function(e,t,n){return e.readBytes(n.text.blockSize)}},a]},c={label:"frames",parts:[i,{label:"application",requires:function(e,t,n){var r=e.peekBytes(2);return 33===r[0]&&255===r[1]},parts:[{label:"codes",parser:r.readBytes(2),skip:!0},{label:"blockSize",parser:r.readByte()},{label:"id",parser:function(e,t,n){return e.readString(n.blockSize)}},a]},{label:"comment",requires:function(e,t,n){var r=e.peekBytes(2);return 33===r[0]&&254===r[1]},parts:[{label:"codes",parser:r.readBytes(2),skip:!0},a]},o,l],loop:function(e){var t=e.peekByte();return 33===t||44===t}},u=[{label:"header",parts:[{label:"signature",parser:r.readString(3)},{label:"version",parser:r.readString(3)}]},{label:"lsd",parts:[{label:"width",parser:r.readUnsigned(!0)},{label:"height",parser:r.readUnsigned(!0)},{label:"gct",bits:{exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}}},{label:"backgroundColorIndex",parser:r.readByte()},{label:"pixelAspectRatio",parser:r.readByte()}]},{label:"gct",requires:function(e,t){return t.lsd.gct.exists},parser:r.readArray(3,function(e,t){return Math.pow(2,t.lsd.gct.size+1)})},c];e.exports=u},function(e,t,n){"use strict";var r={readByte:function(){return function(e){return e.readByte()}},readBytes:function(e){return function(t){return t.readBytes(e)}},readString:function(e){return function(t){return t.readString(e)}},readUnsigned:function(e){return function(t){return t.readUnsigned(e)}},readArray:function(e,t){return function(n,r,a){for(var i=t(n,r,a),o=new Array(i),l=0;l<i;l++)o[l]=n.readBytes(e);return o}}};e.exports=r},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(2)),i=n(2),o=n(6);t.VFXImg=function(e){var t=i.useContext(o.VFXContext),n=i.useRef(null),r=i.useCallback(function(){var r;if(null!==n.current){var a=e.shader;return null===(r=t)||void 0===r||r.addElement(n.current,{shader:a}),function(){var e;null!==n.current&&(null===(e=t)||void 0===e||e.removeElement(n.current))}}},[e.shader,t]);return a.createElement("img",Object.assign({ref:n},e,{onLoad:r}))}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(2)),i=n(2),o=n(6);t.VFXVideo=function(e){var t=i.useContext(o.VFXContext),n=i.useRef(null),r=i.useCallback(function(){var r;if(null!==n.current){var a=e.shader;return null===(r=t)||void 0===r||r.addElement(n.current,{shader:a}),function(){var e;null!==n.current&&(null===(e=t)||void 0===e||e.removeElement(n.current))}}},[e.shader,t]);return a.createElement("video",Object.assign({ref:n},e,{onLoadedData:r}))}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(2)),i=n(2),o=n(6);t.default=function(e){return function(t){var n=i.useContext(o.VFXContext),r=i.useRef(null);return i.useEffect(function(){var e,a=r.current;if(null!==a){var i=t.shader;return null===(e=n)||void 0===e||e.addElement(a,{shader:i}),function(){var e;null===(e=n)||void 0===e||e.removeElement(a)}}},[r,n,t.shader]),i.useEffect(function(){var e;null!==r.current&&(null===(e=n)||void 0===e||e.updateElement(r.current))},[n,t.children]),a.createElement(e,Object.assign(Object.assign({},t),{ref:r}))}}},function(e,t,n){var r=n(59);"string"==typeof r&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1};n(5)(r,a);r.locals&&(e.exports=r.locals)},function(e,t,n){},function(e,t,n){var r=n(61);"string"==typeof r&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1};n(5)(r,a);r.locals&&(e.exports=r.locals)},function(e,t,n){},function(e,t,n){var r={"./0-title.md":63,"./01-intro.md":64,"./02-why.md":65,"./03-how-it-works.md":66,"./04-fiber.md":67,"./05-conclusion.md":68};function a(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id=62},function(e,t,n){"use strict";n.r(t),n.d(t,"slides",function(){return u}),n.d(t,"fusumaProps",function(){return s}),n.d(t,"default",function(){return m});var r=n(3),a=n(2),i=n.n(a),o=n(1);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=[function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h1",null,Object(o.a)(r.VFXImg,{src:n(15),alt:"REACT-VFX",shader:"glitch"})))}],s=[{}],f={slides:u},p="wrapper";function m(e){var t=e.components,a=c(e,["components"]);return Object(o.a)(p,l({},f,a,{components:t,mdxType:"MDXLayout"}),Object(o.a)("h1",null,Object(o.a)(r.VFXImg,{src:n(15),alt:"REACT-VFX",shader:"glitch"})))}m.isMDXComponent=!0},function(e,t,n){"use strict";n.r(t),n.d(t,"slides",function(){return p}),n.d(t,"fusumaProps",function(){return m}),n.d(t,"default",function(){return v});var r=n(3),a=n(12),i=n(11),o=n.n(i),l=n(2),c=n.n(l),u=n(1);function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var p=[function(e){return Object(u.a)(c.a.Fragment,null,Object(u.a)(a.a,(t={left:Object(u.a)(r.VFXImg,{src:n(16),shader:"rgbShift"}),right:Object(u.a)(c.a.Fragment,null,Object(u.a)("h1",null,"自己紹介"),Object(u.a)("ul",null,Object(u.a)("li",null,Object(u.a)("a",{href:"https://twitter.com/amagitakayosi"},"@amagitakayosi")),Object(u.a)("li",null,"Kyoto.js主催"))),mdxType:"Card"},o="Card",(i="mdxType")in t?Object.defineProperty(t,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[i]=o,t)));var t,i,o},function(e){return Object(u.a)(c.a.Fragment,null,Object(u.a)("h2",null,"WebGLでVJやってます"),Object(u.a)("video",{src:o.a,autoPlay:!0,loop:!0,muted:!0}))},function(e){return Object(u.a)(c.a.Fragment,null,Object(u.a)("h2",null,Object(u.a)(r.VFXDiv,{shader:"rainbow"},"こんなん作りました")),Object(u.a)("p",null,Object(u.a)("a",f({parentName:"p"},{href:"https://amagi.dev/react-vfx/"}),"https://amagi.dev/react-vfx/")))}],m=[{sectionTitle:"自己紹介",note:"This is a speaker note!!\nThis sentence can be seen when using Presenter Mode.\n\n😍"},{},{}],d={slides:p},b="wrapper";function v(e){var t=e.components,i=s(e,["components"]);return Object(u.a)(b,f({},d,i,{components:t,mdxType:"MDXLayout"}),Object(u.a)(a.a,{left:Object(u.a)(r.VFXImg,{src:n(16),shader:"rgbShift"}),right:Object(u.a)(c.a.Fragment,null,Object(u.a)("h1",null,"自己紹介"),Object(u.a)("ul",null,Object(u.a)("li",null,Object(u.a)("a",{href:"https://twitter.com/amagitakayosi"},"@amagitakayosi")),Object(u.a)("li",null,"Kyoto.js主催"))),mdxType:"Card"}),Object(u.a)("hr",null),Object(u.a)("h2",null,"WebGLでVJやってます"),Object(u.a)("video",{src:o.a,autoPlay:!0,loop:!0,muted:!0}),Object(u.a)("hr",null),Object(u.a)("h2",null,Object(u.a)(r.VFXDiv,{shader:"rainbow"},"こんなん作りました")),Object(u.a)("p",null,Object(u.a)("a",f({parentName:"p"},{href:"https://amagi.dev/react-vfx/"}),"https://amagi.dev/react-vfx/")))}v.isMDXComponent=!0},function(e,t,n){"use strict";n.r(t),n.d(t,"slides",function(){return u}),n.d(t,"fusumaProps",function(){return s}),n.d(t,"default",function(){return m});var r=n(3),a=n(2),i=n.n(a),o=n(1);function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var u=[function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h1",null,Object(o.a)(r.VFXDiv,{shader:"rgbShift"},"経緯")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"ぼく「ポートフォリオ作りたいな〜」"),Object(o.a)("li",{parentName:"ul"},"ぼく「参考に",Object(o.a)("a",c({parentName:"li"},{href:"https://www.awwwards.com/"}),"AWWWARDS"),"でもみるか」",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"僕はChromeに",Object(o.a)("a",c({parentName:"li"},{href:"https://usepanda.com/"}),"Panda"),"入れてます")))))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("p",null,"この画像エフェクトかっこいいな〜"),Object(o.a)("a",{href:"https://www.sachatourtoulou.com/work"},Object(o.a)("img",{src:n(17),alt:"AWWWARDS example 1"})))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("p",null,"かっけ〜！"),Object(o.a)("a",{href:"https://collection-wakawaka.world/objects"},Object(o.a)("img",{src:n(18),alt:"AWWWARDS example 1"})))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("img",{className:"bg",src:n(19)}),Object(o.a)("h2",null,"僕の",Object(o.a)("a",c({parentName:"h2"},{href:"https://github.com/fand/vedajs"}),"VEDAJS"),"で作れるかな？"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"WebGL(GLSL)でアニメーションを描画するライブラリ"),Object(o.a)("li",{parentName:"ul"},"要素の数だけcanvasを生成する必要があり、非効率"),Object(o.a)("li",{parentName:"ul"},"WebGL contextの数に上限アリ(",Object(o.a)("a",c({parentName:"li"},{href:"https://www.reddit.com/r/firefox/comments/7m6iph/webgl_context_limit/"}),"ソース"),")")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"Spector.jsで見てみる"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",c({parentName:"li"},{href:"https://github.com/BabylonJS/Babylon.js"}),"BabylonJS"),"チームによるWebGLデバッグツール"),Object(o.a)("li",{parentName:"ul"},"どういう順番で描画命令とかテクスチャを見れる")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("img",{src:n(20),alt:"Spectorの画面"}))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"Devtools見た結果"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"ページ全体にcanvas一枚"),Object(o.a)("li",{parentName:"ul"},"画像ごとに描画されてる"),Object(o.a)("li",{parentName:"ul"},"Three.jsの場合、画像毎にシーン作って",Object(o.a)("br",null),"\nviewport設定して描画すれば良さそう")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("p",null,"参考: Three.jsのexample"),Object(o.a)("img",{src:n(21)}))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"できました"),Object(o.a)("a",{href:"https://amagi.dev/react-vfx/",target:"_blank"},Object(o.a)("img",{src:n(7),alt:"REACT-VFX 完成の様子"})))}],s=[{sectionTitle:"経緯",classes:"section-blue"},{},{},{},{},{},{},{},{},{classes:"section-red"}],f={slides:u},p="wrapper";function m(e){var t=e.components,a=l(e,["components"]);return Object(o.a)(p,c({},f,a,{components:t,mdxType:"MDXLayout"}),Object(o.a)("h1",null,Object(o.a)(r.VFXDiv,{shader:"rgbShift"},"経緯")),Object(o.a)("hr",null),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"ぼく「ポートフォリオ作りたいな〜」"),Object(o.a)("li",{parentName:"ul"},"ぼく「参考に",Object(o.a)("a",c({parentName:"li"},{href:"https://www.awwwards.com/"}),"AWWWARDS"),"でもみるか」",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"僕はChromeに",Object(o.a)("a",c({parentName:"li"},{href:"https://usepanda.com/"}),"Panda"),"入れてます")))),Object(o.a)("hr",null),Object(o.a)("p",null,"この画像エフェクトかっこいいな〜"),Object(o.a)("a",{href:"https://www.sachatourtoulou.com/work"},Object(o.a)("img",{src:n(17),alt:"AWWWARDS example 1"})),Object(o.a)("hr",null),Object(o.a)("p",null,"かっけ〜！"),Object(o.a)("a",{href:"https://collection-wakawaka.world/objects"},Object(o.a)("img",{src:n(18),alt:"AWWWARDS example 1"})),Object(o.a)("hr",null),Object(o.a)("img",{className:"bg",src:n(19)}),Object(o.a)("h2",null,"僕の",Object(o.a)("a",c({parentName:"h2"},{href:"https://github.com/fand/vedajs"}),"VEDAJS"),"で作れるかな？"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"WebGL(GLSL)でアニメーションを描画するライブラリ"),Object(o.a)("li",{parentName:"ul"},"要素の数だけcanvasを生成する必要があり、非効率"),Object(o.a)("li",{parentName:"ul"},"WebGL contextの数に上限アリ(",Object(o.a)("a",c({parentName:"li"},{href:"https://www.reddit.com/r/firefox/comments/7m6iph/webgl_context_limit/"}),"ソース"),")")),Object(o.a)("hr",null),Object(o.a)("h2",null,"Spector.jsで見てみる"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",c({parentName:"li"},{href:"https://github.com/BabylonJS/Babylon.js"}),"BabylonJS"),"チームによるWebGLデバッグツール"),Object(o.a)("li",{parentName:"ul"},"どういう順番で描画命令とかテクスチャを見れる")),Object(o.a)("hr",null),Object(o.a)("img",{src:n(20),alt:"Spectorの画面"}),Object(o.a)("hr",null),Object(o.a)("h2",null,"Devtools見た結果"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"ページ全体にcanvas一枚"),Object(o.a)("li",{parentName:"ul"},"画像ごとに描画されてる"),Object(o.a)("li",{parentName:"ul"},"Three.jsの場合、画像毎にシーン作って",Object(o.a)("br",null),"\nviewport設定して描画すれば良さそう")),Object(o.a)("hr",null),Object(o.a)("p",null,"参考: Three.jsのexample"),Object(o.a)("img",{src:n(21)}),Object(o.a)("hr",null),Object(o.a)("h2",null,"できました"),Object(o.a)("a",{href:"https://amagi.dev/react-vfx/",target:"_blank"},Object(o.a)("img",{src:n(7),alt:"REACT-VFX 完成の様子"})))}m.isMDXComponent=!0},function(e,t,n){"use strict";n.r(t),n.d(t,"slides",function(){return u}),n.d(t,"fusumaProps",function(){return s}),n.d(t,"default",function(){return m});var r=n(3),a=n(2),i=n.n(a),o=n(1);function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var u=[function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h1",null,"react-vfxの仕組み"))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"登場人物"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"VFXPlayer: シーン管理、描画"),Object(o.a)("li",{parentName:"ul"},"VFXProvider: canvas生成、Player初期化"),Object(o.a)("li",{parentName:"ul"},"VFXElement: img等のラッパー")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"処理の流れ"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("ol",{parentName:"li"},Object(o.a)("li",{parentName:"ol"},"VFXProviderがcanvasを生成"))),Object(o.a)("li",{parentName:"ul"},Object(o.a)("ol",c({parentName:"li"},{start:2}),Object(o.a)("li",{parentName:"ol"},"Elementsのマウント時に登録"))),Object(o.a)("li",{parentName:"ul"},Object(o.a)("ol",c({parentName:"li"},{start:3}),Object(o.a)("li",{parentName:"ol"},"メインループ")),Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"要素の位置を更新"),Object(o.a)("li",{parentName:"ul"},"画面内の要素を描画")))))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("img",{src:n(22)}))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"1. VFXProvider"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"画面全体を覆うcanvasを生成"),Object(o.a)("li",{parentName:"ul"},"VFXPlayerを初期化",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"Three.js周りを管理するクラス"))),Object(o.a)("li",{parentName:"ul"},"ContextにVFXPlayerを渡す")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("p",null,"hooks便利〜"),Object(o.a)("pre",null,Object(o.a)("code",c({parentName:"pre"},{className:"language-javascript"}),"const VFXContext = createContext(null);\n\nconst VFXProvider = props => {\n  const [player, setPlayer] = useState(null);\n\n  useEffect(() => {\n    // 中略\n\n    const p = new VFXPlayer(canvas)\n    setPlayer(p);\n\n    // 中略\n  }, []);\n\n  return (\n    <VFXContext.Provider value={player}>\n      {props.children}\n    </VFXContext.Provider>\n  );\n};\n")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"VFXElements"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"マウント時にVFXPlayerに登録"),Object(o.a)("li",{parentName:"ul"},"要素に応じてTextureを作成",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"img, video: そのままThree.jsに渡す",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"WebGLはvideo要素から直接テクスチャ作れて最高！"))),Object(o.a)("li",{parentName:"ul"},"span, div: 気合で画像に変換（後述）")))))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("p",null,"hooks便利〜"),Object(o.a)("pre",null,Object(o.a)("code",c({parentName:"pre"},{className:"language-javascript　"}),"const VFXImg = props => {\n  const { shader } = props;\n  const player = useContext(VFXContext);\n  const ref = useRef(null);\n\n  // 画像ロード後に呼ぶ\n  const init = useCallback(() => {\n    // VFXPlayerに登録\n    player?.addElement(ref.current, { shader });\n\n    return () => {\n        // VFXPlayerから削除\n        player?.removeElement(ref.current);\n    };\n  }, [shader, player]);\n\n  return <img ref={ref} {...props} onLoad={init} />;\n};\n")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"3.メインループ"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"各要素の要素の位置を毎フレーム取得"),Object(o.a)("li",{parentName:"ul"},"画面内にあれば、その位置にテクスチャを描画"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("b",null,Object(o.a)(r.VFXDiv,{shader:"rainbow"},"まあまあ重いけど動くからヨシ！")))))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h3",null,"IntersectionObserverは？"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"試したけど微妙だった"),Object(o.a)("li",{parentName:"ul"},"コールバックの実行がたまに遅れる(？)"),Object(o.a)("li",{parentName:"ul"},"iOSで触ってるときに遅れてきたりする(？)"),Object(o.a)("li",{parentName:"ul"},"遅延ロード等に使われるAPIだから仕方ない……")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"テキストを画像に変換"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"当初は",Object(o.a)("a",c({parentName:"li"},{href:"https://html2canvas.hertzen.com/"}),"html2canvas"),"を使用"),Object(o.a)("li",{parentName:"ul"},"遅い上に無駄なリクエストが走りまくるので断念",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"キャプチャするたびにページ全体をクローンする"),Object(o.a)("li",{parentName:"ul"},"正確にスタイルを再現するには",Object(o.a)("br",null),"\nページ全体をクローンする必要があるため")))))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"今回は、最低限プレーンテキストが画像化できれば良い"),Object(o.a)("li",{parentName:"ul"},"SVGの",Object(o.a)("a",c({parentName:"li"},{href:"https://developer.mozilla.org/ja/docs/Web/SVG/Element/foreignObject#Browser_compatibility"}),"foreignObject"),"を使う",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"SVGにDOMを埋め込める奴")))))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h3",null,"dom2canvasの流れ"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"画像化したい要素をクローン",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"親要素もクローン (vertical-align等の再現に必要)"))),Object(o.a)("li",{parentName:"ul"},"outerHTMLからSVG文字列を作成"),Object(o.a)("li",{parentName:"ul"},"canvasに描画"),Object(o.a)("li",{parentName:"ul"},"THREE.Textureにcanvasを渡す")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("h2",null,"dom2canvasの困りごと"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"微妙にズレたりズレなかったりする",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"html2canvasでもズレてたのでムズそう"))),Object(o.a)("li",{parentName:"ul"},"子要素があるとおかしくなる"),Object(o.a)("li",{parentName:"ul"},"改行するとおかしくなる"),Object(o.a)("li",{parentName:"ul"},"クロスオリジンなリソースを読み込めない")))},function(e){return Object(o.a)(i.a.Fragment,null,Object(o.a)("p",null,"なんかいい方法あったら教えてください"))}],s=[{sectionTitle:"仕組み",classes:"section-blue"},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],f={slides:u},p="wrapper";function m(e){var t=e.components,a=l(e,["components"]);return Object(o.a)(p,c({},f,a,{components:t,mdxType:"MDXLayout"}),Object(o.a)("h1",null,"react-vfxの仕組み"),Object(o.a)("hr",null),Object(o.a)("h2",null,"登場人物"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"VFXPlayer: シーン管理、描画"),Object(o.a)("li",{parentName:"ul"},"VFXProvider: canvas生成、Player初期化"),Object(o.a)("li",{parentName:"ul"},"VFXElement: img等のラッパー")),Object(o.a)("hr",null),Object(o.a)("h2",null,"処理の流れ"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("ol",{parentName:"li"},Object(o.a)("li",{parentName:"ol"},"VFXProviderがcanvasを生成"))),Object(o.a)("li",{parentName:"ul"},Object(o.a)("ol",c({parentName:"li"},{start:2}),Object(o.a)("li",{parentName:"ol"},"Elementsのマウント時に登録"))),Object(o.a)("li",{parentName:"ul"},Object(o.a)("ol",c({parentName:"li"},{start:3}),Object(o.a)("li",{parentName:"ol"},"メインループ")),Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"要素の位置を更新"),Object(o.a)("li",{parentName:"ul"},"画面内の要素を描画")))),Object(o.a)("hr",null),Object(o.a)("img",{src:n(22)}),Object(o.a)("hr",null),Object(o.a)("h2",null,"1. VFXProvider"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"画面全体を覆うcanvasを生成"),Object(o.a)("li",{parentName:"ul"},"VFXPlayerを初期化",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"Three.js周りを管理するクラス"))),Object(o.a)("li",{parentName:"ul"},"ContextにVFXPlayerを渡す")),Object(o.a)("hr",null),Object(o.a)("p",null,"hooks便利〜"),Object(o.a)("pre",null,Object(o.a)("code",c({parentName:"pre"},{className:"language-javascript"}),"const VFXContext = createContext(null);\n\nconst VFXProvider = props => {\n  const [player, setPlayer] = useState(null);\n\n  useEffect(() => {\n    // 中略\n\n    const p = new VFXPlayer(canvas)\n    setPlayer(p);\n\n    // 中略\n  }, []);\n\n  return (\n    <VFXContext.Provider value={player}>\n      {props.children}\n    </VFXContext.Provider>\n  );\n};\n")),Object(o.a)("hr",null),Object(o.a)("h2",null,"VFXElements"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"マウント時にVFXPlayerに登録"),Object(o.a)("li",{parentName:"ul"},"要素に応じてTextureを作成",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"img, video: そのままThree.jsに渡す",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"WebGLはvideo要素から直接テクスチャ作れて最高！"))),Object(o.a)("li",{parentName:"ul"},"span, div: 気合で画像に変換（後述）")))),Object(o.a)("hr",null),Object(o.a)("p",null,"hooks便利〜"),Object(o.a)("pre",null,Object(o.a)("code",c({parentName:"pre"},{className:"language-javascript　"}),"const VFXImg = props => {\n  const { shader } = props;\n  const player = useContext(VFXContext);\n  const ref = useRef(null);\n\n  // 画像ロード後に呼ぶ\n  const init = useCallback(() => {\n    // VFXPlayerに登録\n    player?.addElement(ref.current, { shader });\n\n    return () => {\n        // VFXPlayerから削除\n        player?.removeElement(ref.current);\n    };\n  }, [shader, player]);\n\n  return <img ref={ref} {...props} onLoad={init} />;\n};\n")),Object(o.a)("hr",null),Object(o.a)("h2",null,"3.メインループ"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"各要素の要素の位置を毎フレーム取得"),Object(o.a)("li",{parentName:"ul"},"画面内にあれば、その位置にテクスチャを描画"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("b",null,Object(o.a)(r.VFXDiv,{shader:"rainbow"},"まあまあ重いけど動くからヨシ！")))),Object(o.a)("hr",null),Object(o.a)("h3",null,"IntersectionObserverは？"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"試したけど微妙だった"),Object(o.a)("li",{parentName:"ul"},"コールバックの実行がたまに遅れる(？)"),Object(o.a)("li",{parentName:"ul"},"iOSで触ってるときに遅れてきたりする(？)"),Object(o.a)("li",{parentName:"ul"},"遅延ロード等に使われるAPIだから仕方ない……")),Object(o.a)("hr",null),Object(o.a)("h2",null,"テキストを画像に変換"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"当初は",Object(o.a)("a",c({parentName:"li"},{href:"https://html2canvas.hertzen.com/"}),"html2canvas"),"を使用"),Object(o.a)("li",{parentName:"ul"},"遅い上に無駄なリクエストが走りまくるので断念",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"キャプチャするたびにページ全体をクローンする"),Object(o.a)("li",{parentName:"ul"},"正確にスタイルを再現するには",Object(o.a)("br",null),"\nページ全体をクローンする必要があるため")))),Object(o.a)("hr",null),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"今回は、最低限プレーンテキストが画像化できれば良い"),Object(o.a)("li",{parentName:"ul"},"SVGの",Object(o.a)("a",c({parentName:"li"},{href:"https://developer.mozilla.org/ja/docs/Web/SVG/Element/foreignObject#Browser_compatibility"}),"foreignObject"),"を使う",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"SVGにDOMを埋め込める奴")))),Object(o.a)("hr",null),Object(o.a)("h3",null,"dom2canvasの流れ"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"画像化したい要素をクローン",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"親要素もクローン (vertical-align等の再現に必要)"))),Object(o.a)("li",{parentName:"ul"},"outerHTMLからSVG文字列を作成"),Object(o.a)("li",{parentName:"ul"},"canvasに描画"),Object(o.a)("li",{parentName:"ul"},"THREE.Textureにcanvasを渡す")),Object(o.a)("hr",null),Object(o.a)("h2",null,"dom2canvasの困りごと"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"微妙にズレたりズレなかったりする",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"html2canvasでもズレてたのでムズそう"))),Object(o.a)("li",{parentName:"ul"},"子要素があるとおかしくなる"),Object(o.a)("li",{parentName:"ul"},"改行するとおかしくなる"),Object(o.a)("li",{parentName:"ul"},"クロスオリジンなリソースを読み込めない")),Object(o.a)("hr",null),Object(o.a)("p",null,"なんかいい方法あったら教えてください"))}m.isMDXComponent=!0},function(e,t,n){"use strict";n.r(t),n.d(t,"slides",function(){return c}),n.d(t,"fusumaProps",function(){return u}),n.d(t,"default",function(){return p});var r=n(2),a=n.n(r),i=n(1);function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c=[function(e){return Object(i.a)(a.a.Fragment,null,Object(i.a)("h1",null,"おまけ: 背景"),Object(i.a)("img",{src:n(7),alt:"REACT-VFX 背景アニメーション"}))},function(e){return Object(i.a)(a.a.Fragment,null,Object(i.a)("h2",null,Object(i.a)("a",l({parentName:"h2"},{href:"https://github.com/react-spring/react-three-fiber"}),"react-three-fiber"),"を使用"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},"宣言的にシーンを記述できる"),Object(i.a)("li",{parentName:"ul"},"React + Three.js系ライブラリの中で",Object(i.a)("br",null),"最も筋が良さそう（個人の感想）")),Object(i.a)("pre",null,Object(i.a)("code",l({parentName:"pre"},{className:"language-tsx"}),"<Canvas>\n  <mesh>\n    <boxGeometry args={[1, 1, 1]}/>\n    <meshStandardMaterial/>\n  </mesh>\n</Canvas>\n")))},function(e){return Object(i.a)(a.a.Fragment,null,Object(i.a)("h3",null,"アニメーション用の値"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},"普通にnumberをpropsで渡すと重いので🆖"),Object(i.a)("li",{parentName:"ul"},"react-springのuseSpringを使う",Object(i.a)("ul",{parentName:"li"},Object(i.a)("li",{parentName:"ul"},"アニメーションで使いたい値のラッパー")))))},function(e){return Object(i.a)(a.a.Fragment,null,Object(i.a)("pre",null,Object(i.a)("code",l({parentName:"pre"},{className:"language-javascript"}),"// scrollのラッパーを作る\nconst [{ scroll }, set] = useSpring(() => ({ scroll: 0 }));\nconst onScroll = useCallback(e => {\n  set({ scroll: window.scrollY });\n}, [set]);\n\n// スクロール位置を 0 ~ 1 に変換\nconst top = scroll.interpolate(x => {\n  return x / (document.body.scrollHeight - window.innerHeight);\n});\n\nreturn <>\n  <Triangle top={top} />\n  <Particles top={top} />\n</>;\n")))},function(e){return Object(i.a)(a.a.Fragment,null,Object(i.a)("h2",null,"REACT-VFX本体にも使う？"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},"canvasを直接触りたかったのでやめた",Object(i.a)("ul",{parentName:"li"},Object(i.a)("li",{parentName:"ul"},"react-three-fiberはcanvasやrenderer周りを",Object(i.a)("br",null),"\n抽象化してくれている"),Object(i.a)("li",{parentName:"ul"},"ふつーのWebGLやるのにはメチャ便利")))))}],u=[{sectionTitle:"背景アニメーション",classes:"section-blue"},{},{},{},{}],s={slides:c},f="wrapper";function p(e){var t=e.components,r=o(e,["components"]);return Object(i.a)(f,l({},s,r,{components:t,mdxType:"MDXLayout"}),Object(i.a)("h1",null,"おまけ: 背景"),Object(i.a)("img",{src:n(7),alt:"REACT-VFX 背景アニメーション"}),Object(i.a)("hr",null),Object(i.a)("h2",null,Object(i.a)("a",l({parentName:"h2"},{href:"https://github.com/react-spring/react-three-fiber"}),"react-three-fiber"),"を使用"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},"宣言的にシーンを記述できる"),Object(i.a)("li",{parentName:"ul"},"React + Three.js系ライブラリの中で",Object(i.a)("br",null),"最も筋が良さそう（個人の感想）")),Object(i.a)("pre",null,Object(i.a)("code",l({parentName:"pre"},{className:"language-tsx"}),"<Canvas>\n  <mesh>\n    <boxGeometry args={[1, 1, 1]}/>\n    <meshStandardMaterial/>\n  </mesh>\n</Canvas>\n")),Object(i.a)("hr",null),Object(i.a)("h3",null,"アニメーション用の値"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},"普通にnumberをpropsで渡すと重いので🆖"),Object(i.a)("li",{parentName:"ul"},"react-springのuseSpringを使う",Object(i.a)("ul",{parentName:"li"},Object(i.a)("li",{parentName:"ul"},"アニメーションで使いたい値のラッパー")))),Object(i.a)("hr",null),Object(i.a)("pre",null,Object(i.a)("code",l({parentName:"pre"},{className:"language-javascript"}),"// scrollのラッパーを作る\nconst [{ scroll }, set] = useSpring(() => ({ scroll: 0 }));\nconst onScroll = useCallback(e => {\n  set({ scroll: window.scrollY });\n}, [set]);\n\n// スクロール位置を 0 ~ 1 に変換\nconst top = scroll.interpolate(x => {\n  return x / (document.body.scrollHeight - window.innerHeight);\n});\n\nreturn <>\n  <Triangle top={top} />\n  <Particles top={top} />\n</>;\n")),Object(i.a)("hr",null),Object(i.a)("h2",null,"REACT-VFX本体にも使う？"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},"canvasを直接触りたかったのでやめた",Object(i.a)("ul",{parentName:"li"},Object(i.a)("li",{parentName:"ul"},"react-three-fiberはcanvasやrenderer周りを",Object(i.a)("br",null),"\n抽象化してくれている"),Object(i.a)("li",{parentName:"ul"},"ふつーのWebGLやるのにはメチャ便利")))))}p.isMDXComponent=!0},function(e,t,n){"use strict";n.r(t),n.d(t,"slides",function(){return c}),n.d(t,"fusumaProps",function(){return u}),n.d(t,"default",function(){return p});var r=n(2),a=n.n(r),i=n(1);function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c=[function(e){return Object(i.a)(a.a.Fragment,null,Object(i.a)("h1",null,"まとめ"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},"まだまだ荒削りですがPR歓迎です！！！！"),Object(i.a)("li",{parentName:"ul"},"シェーダー楽しいよ"),Object(i.a)("li",{parentName:"ul"},"みんなもおもしろWebサイト作ろうぜ")))},function(e){return Object(i.a)(a.a.Fragment,null,Object(i.a)("p",null,Object(i.a)("a",l({parentName:"p"},{href:"https://amagi.dev/react-vfx/"}),"https://amagi.dev/react-vfx/")))}],u=[{sectionTitle:"まとめ"},{}],s={slides:c},f="wrapper";function p(e){var t=e.components,n=o(e,["components"]);return Object(i.a)(f,l({},s,n,{components:t,mdxType:"MDXLayout"}),Object(i.a)("h1",null,"まとめ"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},"まだまだ荒削りですがPR歓迎です！！！！"),Object(i.a)("li",{parentName:"ul"},"シェーダー楽しいよ"),Object(i.a)("li",{parentName:"ul"},"みんなもおもしろWebサイト作ろうぜ")),Object(i.a)("hr",null),Object(i.a)("p",null,Object(i.a)("a",l({parentName:"p"},{href:"https://amagi.dev/react-vfx/"}),"https://amagi.dev/react-vfx/")))}p.isMDXComponent=!0},function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r);console.log("???????",a.a)},function(e,t,n){if("/Users/amagi/src/github.com/fand/kyotojs17-slides/style.css".match(/\+*.css$/i))try{n(71)}catch(e){console.error(e)}},function(e,t,n){var r=n(72);"string"==typeof r&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1};n(5)(r,a);r.locals&&(e.exports=r.locals)},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),i=n(14);function o(e){return{id:(t=e).id,slides:t.keys().sort().map(function(e){return t(e)})};var t}var l=n(13),c=function(e){var t=e.list;return function(){return a.a.createElement("div",{className:"toc size-70 aligncenter"},a.a.createElement("ol",null,t.map(function(e,t){var n=e.index,r=e.title;return a.a.createElement("li",{key:t},a.a.createElement("a",{href:"#slide=".concat(n),title:r},a.a.createElement("span",{className:"chapter"},r),a.a.createElement("span",{className:"toc-page"},n)))})))}};function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){var n=[],r=[],a={};return e.forEach(function(e){var t=e.slides,a=e.fusumaProps;n.push.apply(n,u(t)),r.push.apply(r,u(a))}),r.reduce(function(e,t,n){var r=t.sectionTitle;return r&&e.push({title:r,index:n+1}),e},a.contentsList=[]),a.slides=n.map(function(e,t){var n=r[t];return{slide:n.contents?c({list:a.contentsList}):e,fusumaProps:n}}),a}var f=n(9);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e,t,n,r,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){m(i,r,a,o,l,"next",e)}function l(e){m(i,r,a,o,l,"throw",e)}o(void 0)})}}var b,v=function(e){var t=e.slides,i=e.hash,o=new URL(window.location.href),c=o.searchParams,u=(c.get("isLive"),o.hash.match(/^#slide=(.+?)$/)),m=0!==(u=null!==u?u[1]-1:0),b=function(){var e=d(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(0),n.e(11),n.e(3)]).then(n.bind(null,376));case 2:t=e.sent,r=t.Sidebar,M(r);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=d(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("common"!==x){e.next=4;break}W(f.a),e.next=16;break;case 4:if("view"!==x){e.next=10;break}return e.next=7,Promise.all([n.e(0),n.e(1),n.e(7)]).then(n.bind(null,379));case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,Promise.all([n.e(0),n.e(1),n.e(13),n.e(6)]).then(n.bind(null,378));case 12:e.t0=e.sent;case 13:t=e.t0,r=t.default,W(r);case 16:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),h=function(e){var t=e.isOpen;R!==t&&V(t)},g=function(){window.slide=null,W(null),w("common")},O=location.search.includes("presenter=host")?"host":location.search.includes("presenter=view")?"view":"common",j=s(t),y=p(Object(r.useState)(O),2),x=y[0],w=y[1],N=p(Object(r.useState)(j.slides),2),F=N[0],C=N[1],S=p(Object(r.useState)(j.contentsList),2),P=S[0],D=S[1],k=p(Object(r.useState)(!0),2),T=k[0],E=k[1],_=p(Object(r.useState)(!1),2),R=_[0],V=_[1],X=p(Object(r.useState)(u),2),L=X[0],A=X[1],I=p(Object(r.useState)(null),2),B=I[0],M=I[1],z=p(Object(r.useState)("common"===x?f.a:void 0),2),G=z[0],W=z[1],U=p(Object(r.useState)(null),2),H=U[0],q=U[1];Object(r.useEffect)(function(){!function(){var e="false"!==c.get("sidebar")&&"common"===x;V(!1),E(e)}(),B||b(),"host"===x&&q(null),G||v()},[x]);var J=p(Object(r.useState)(i),2),K=J[0],Y=J[1];if(K!==i){var $=s(t);C($.slides),D($.contentsList),Y(i)}return a.a.createElement(a.a.Fragment,null,T&&a.a.createElement(a.a.Fragment,null,B&&a.a.createElement(B,{goTo:function(e){window.slide&&window.slide.goToSlide(e)},isOpen:R,terminate:g,contents:P,onStateChange:h,currentIndex:L,runPresentationMode:function(){window.slide=null,W(null),w("host")}}),a.a.createElement(l.f,{className:"btn-sidebar",onClick:function(){return h({isOpen:!0})}})),G&&a.a.createElement(G,{hash:i,slides:F,isJumpPage:m,terminate:g,currentIndex:L,onChangeSlideIndex:function(e){A(e)}}),H&&a.a.createElement(H,null))};n(58),n(60);function h(e,t,n,r,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,i.hydrate)(a.a.createElement(v,{slides:e,hash:t}),document.getElementById("root"))}(b=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g(o(n(62)).slides),document.addEventListener("click",function(e){if("A"===e.target.tagName){if(e.target.host===location.host||""===e.target.href)return;e.preventDefault(),window.open(e.target.href,"_blank")}});case 4:case"end":return e.stop()}},e)}),function(){var e=this,t=arguments;return new Promise(function(n,r){var a=b.apply(e,t);function i(e){h(a,n,r,i,o,"next",e)}function o(e){h(a,n,r,i,o,"throw",e)}i(void 0)})})()}],[[26,8,9]],[0,11,3]]);